---
title: "Как устроена сетка в трещине (MRST)"
date: 2024-07-11
tags: ["MRST", "Сетка", "Трещина"]
language: 'ru-Ru'
---

Есть основная сетка, она содержит в себе сетки внутри трещин
Grid
Grid.FractGrid: Frac1, Fract2,...FracN.


Предположим, что у нас одна трещина и обозначим 

$$
Gf = Grid.FracGrid('Frac1')
$$

Чтобы получить глобальный индекс ячейки трещины, через которую проходит ГС, необходимо вызвать следующую команду в консоли матлаба

$$
xfcellID = nncWells.XFracCellIDs(i, 1),
$$
где \(nncWells\) -- это несоседние соединения \(i\)-ой трещины и ГС.

У сетки трещины есть поле, указывающая на глобальный индекс, с которого начинается ячейки трещины в глобальном векторе ячеек. 
$$
frac1CellStart = Gf.cells.start;
$$

Чтобы получить локальный индекс ячейки трещины, которая пересекается со скважиной
$$
frac1WellLocalIndex =xfcellID - frac1CellStart + 1;
$$

Ячейка трещины представляет из себя прямоугольный параллелепипед. Значит у него есть 6 сторон. 
Чтобы найти индексы сторон этих ячеек
$$
start0 = 6 * (frac1WellLocalIndex - 1); \\
frac1CellFaces = Gf.cells.faces(start0 +1 :start0 + 6);
$$

Сумма расходов через эти грани (= дебит \(i\)-ой трещины)
$$
a = b + Gf.faces.start - 1; \\
frac1Rate = sum(abs(flux(a)));
$$
Здесь необходимо из локальных индексов \(b\) граней перейти к глобальным \(a\).